{
  "dashboard": {
    "id": null,
    "uid": "car-monitor-v5",
    "title": "Car Monitoring v5.0",
    "timezone": "browser",
    "schemaVersion": 37,
    "version": 1,
    "refresh": "15s",
    "panels": [
      {
        "type": "gauge",
        "title": "NUC CPU %",
        "gridPos": {"x":0,"y":0,"w":6,"h":5},
        "targets": [{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"cpu\" and r._field==\"usage_idle\") |> last() |> map(fn:(r)=>({ _value:100-r._value }))"}],
        "fieldConfig":{"defaults":{"unit":"percent","thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":70},{"color":"red","value":90}]}}}
      },
      {
        "type": "gauge",
        "title": "NUC RAM %",
        "gridPos":{"x":6,"y":0,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mem\" and r._field==\"used_percent\") |> last()"}],
        "fieldConfig":{"defaults":{"unit":"percent","thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":70},{"color":"red","value":90}]}}}
      },
      {
        "type":"gauge",
        "title":"NUC Disk %",
        "gridPos":{"x":0,"y":5,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"disk\" and r._field==\"used_percent\") |> last()"}],
        "fieldConfig":{"defaults":{"unit":"percent","thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":80},{"color":"red","value":90}]}}}
      },
      {
        "type":"gauge",
        "title":"NUC CPU Temp",
        "gridPos":{"x":6,"y":5,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"nuc_cpu_temp\" and r._field==\"core0\") |> last()"}],
        "fieldConfig":{"defaults":{"unit":"celsius","thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":65},{"color":"red","value":80}]}}}
      },
      {
        "type":"timeseries",
        "title":"LTE RX MB/s",
        "gridPos":{"x":0,"y":10,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"rx_bytes\") |> derivative(nonNegative:true) |> map(fn:(r)=>({ _value:r._value/1048576 }))"}],
        "fieldConfig":{"defaults":{"unit":"decmbytes"}}
      },
      {
        "type":"timeseries",
        "title":"LTE TX MB/s",
        "gridPos":{"x":6,"y":10,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"tx_bytes\") |> derivative(nonNegative:true) |> map(fn:(r)=>({ _value:r._value/1048576 }))"}],
        "fieldConfig":{"defaults":{"unit":"decmbytes"}}
      },
      {
        "type":"stat",
        "title":"LTE Total RX GB",
        "gridPos":{"x":0,"y":15,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:0) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"rx_bytes\") |> last() |> map(fn:(r)=>({ _value:r._value/1073741824 }))"}],
        "fieldConfig":{"defaults":{"unit":"decbytes"}}
      },
      {
        "type":"stat",
        "title":"LTE Total TX GB",
        "gridPos":{"x":6,"y":15,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:0) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"tx_bytes\") |> last() |> map(fn:(r)=>({ _value:r._value/1073741824 }))"}],
        "fieldConfig":{"defaults":{"unit":"decbytes"}}
      },
      {
        "type":"stat",
        "title":"Public IP",
        "gridPos":{"x":0,"y":20,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"address\") |> last()"}]
      },
      {
        "type":"gauge",
        "title":"Router Voltage",
        "gridPos":{"x":6,"y":20,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_system_health\" and r._field==\"voltage\") |> last()"}],
        "fieldConfig":{"defaults":{"unit":"volt","thresholds":{"mode":"absolute","steps":[{"color":"red","value":12},{"color":"yellow","value":13},{"color":"green","value":14}]}}}
      },
      {
        "type":"gauge",
        "title":"Router Temp",
        "gridPos":{"x":0,"y":25,"w":6,"h":5},
        "targets":[{"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_system_health\" and r._field==\"temperature\") |> last()"}],
        "fieldConfig":{"defaults":{"unit":"celsius","thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":60},{"color":"red","value":75}]}}}
      }
    ]
  },
  "overwrite": true
}
