{
  "dashboard": {
    "id": null,
    "uid": "car-monitor-v4-1",
    "title": "Car Monitor v4.1 Alfa",
    "schemaVersion": 37,
    "timezone": "browser",
    "version": 1,
    "panels": [
      {
        "type": "gauge",
        "title": "NUC CPU %",
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"color":"green","value":0},
                {"color":"yellow","value":70},
                {"color":"red","value":90}
              ]
            }
          }
        },
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r) => r._measurement==\"cpu\" and r._field==\"usage_idle\") |> last() |> map(fn: (r) => ({ _value: 100 - r._value }))"}
        ],
        "gridPos": {"h":5,"w":6,"x":0,"y":0}
      },
      {
        "type": "gauge",
        "title": "NUC RAM %",
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "thresholds": {"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":70},{"color":"red","value":90}]}
          }
        },
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mem\" and r._field==\"used_percent\") |> last()"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":0}
      },
      {
        "type": "gauge",
        "title": "NUC Disk %",
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "thresholds": {"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":80},{"color":"red","value":90}]}
          }
        },
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"disk\" and r._field==\"used_percent\") |> last()"}
        ],
        "gridPos":{"h":5,"w":6,"x":0,"y":5}
      },
      {
        "type": "gauge",
        "title": "NUC CPU Temp",
        "fieldConfig": {
          "defaults": {
            "unit": "celsius",
            "thresholds": {"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":65},{"color":"red","value":80}]}
          }
        },
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"nuc_cpu_temp\" and r._field==\"core0\") |> last()"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":5}
      },
      {
        "type": "graph",
        "title": "LTE RX MB/s",
        "fieldConfig":{"defaults":{"unit":"decmbytes"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"rx_bytes\") |> derivative(nonNegative:true) |> map(fn:(r)=>({ _value:r._value/1048576 }))"}
        ],
        "gridPos":{"h":5,"w":6,"x":0,"y":10}
      },
      {
        "type": "graph",
        "title": "LTE TX MB/s",
        "fieldConfig":{"defaults":{"unit":"decmbytes"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"tx_bytes\") |> derivative(nonNegative:true) |> map(fn:(r)=>({ _value:r._value/1048576 }))"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":10}
      },
      {
        "type": "stat",
        "title": "LTE Total RX GB",
        "fieldConfig":{"defaults":{"unit":"decmbytes"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:0) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"rx_bytes\") |> last() |> map(fn:(r)=>({ _value: r._value / 1073741824 }))"}
        ],
        "gridPos":{"h":5,"w":6,"x":0,"y":15}
      },
      {
        "type": "stat",
        "title": "LTE Total TX GB",
        "fieldConfig":{"defaults":{"unit":"decmbytes"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:0) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"tx_bytes\") |> last() |> map(fn:(r)=>({ _value: r._value / 1073741824 }))"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":15}
      },
      {
        "type": "graph",
        "title": "LTE RSRP",
        "fieldConfig":{"defaults":{"unit":"dbm"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_lte\" and r._field==\"rsrp\")"}
        ],
        "gridPos":{"h":5,"w":6,"x":0,"y":20}
      },
      {
        "type": "graph",
        "title": "LTE RSRQ",
        "fieldConfig":{"defaults":{"unit":"db"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_lte\" and r._field==\"rsrq\")"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":20}
      },
      {
        "type": "graph",
        "title": "LTE SINR",
        "fieldConfig":{"defaults":{"unit":"db"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_lte\" and r._field==\"sinr\")"}
        ],
        "gridPos":{"h":6,"w":6,"x":0,"y":25}
      },
      {
        "type": "stat",
        "title": "Public IP",
        "fieldConfig":{"defaults":{"unit":"none"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-1h) |> filter(fn:(r)=>r._measurement==\"mikrotik_interface\" and r._field==\"address\") |> last()"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":25}
      },
      {
        "type": "stat",
        "title": "Router Voltage",
        "fieldConfig":{"defaults":{"unit":"volt","thresholds":{"mode":"absolute","steps":[{"color":"green","value":13},{"color":"yellow","value":12},{"color":"red","value":0}]}}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_system_health\" and r._field==\"voltage\") |> last()"}
        ],
        "gridPos":{"h":5,"w":6,"x":0,"y":31}
      },
      {
        "type": "stat",
        "title": "Router Temp",
        "fieldConfig":{"defaults":{"unit":"celsius","thresholds":{"mode":"absolute","steps":[{"color":"green","value":60},{"color":"yellow","value":75},{"color":"red","value":75}]}}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_system_health\" and r._field==\"temperature\") |> last()"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":31}
      },
      {
        "type": "graph",
        "title": "Ping",
        "fieldConfig":{"defaults":{"unit":"ms"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"ping\" and r._field==\"latency\")"}
        ],
        "gridPos":{"h":5,"w":6,"x":0,"y":36}
      },
      {
        "type": "graph",
        "title": "Uptime",
        "fieldConfig":{"defaults":{"unit":"s"}},
        "targets":[
          {"query":"from(bucket:\"telemetry\") |> range(start:-5m) |> filter(fn:(r)=>r._measurement==\"mikrotik_system_health\" and r._field==\"uptime\")"}
        ],
        "gridPos":{"h":5,"w":6,"x":6,"y":36}
      }
    ]
  }
}

